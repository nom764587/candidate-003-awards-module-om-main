<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Badge Issuance & Notification - Demo</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #ffd700 0%, #ffb347 100%);
            min-height: 100vh;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .demo-header {
            text-align: center;
            color: white;
            margin-bottom: 60px;
        }

        .demo-header h1 {
            font-size: 3rem;
            margin-bottom: 20px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .demo-header p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .demo-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1);
        }

        .demo-section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 2rem;
        }

        .demo-section p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            overflow-x: auto;
        }

        .code-block pre {
            margin: 0;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            line-height: 1.5;
        }

        .api-endpoint {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .api-endpoint strong {
            color: #1976d2;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .feature-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .feature-card h3 {
            color: #333;
            margin-bottom: 10px;
        }

        .feature-card p {
            color: #666;
            font-size: 14px;
            margin: 0;
        }

        .demo-controls {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 30px;
            margin: 30px 0;
        }

        .demo-controls h3 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .control-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .control-group label {
            font-weight: 600;
            color: #333;
            min-width: 120px;
        }

        .control-group input, .control-group select {
            flex: 1;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 6px;
            font-size: 14px;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-card h3 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .stat-card p {
            margin: 0;
            opacity: 0.9;
            color: unset !important;
        }

        .response-display {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
            white-space: pre-wrap;
            max-height: 200px;
            overflow-y: auto;
        }

        .success {
            background: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }

        .error {
            background: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }

        @media (max-width: 768px) {
            .demo-header h1 {
                font-size: 2rem;
            }
            
            .demo-section {
                padding: 20px;
            }

            .control-group {
                flex-direction: column;
                align-items: stretch;
            }

            .control-group label {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <div class="demo-header">
            <h1>üèÜ Badge Issuance & Notification System</h1>
            <p>Experience real-time badge notifications and management for influencers. Issue badges, receive instant notifications, and track achievements seamlessly.</p>
        </div>

        <div class="demo-section">
            <h2>üìä Live Demo Dashboard</h2>
            <p>This demonstration shows how the Badge Notification System works in real-time. You can issue badges and see instant notifications appear.</p>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <h3 id="total-badges">0</h3>
                    <p>Total Badges Issued</p>
                </div>
                <div class="stat-card">
                    <h3 id="unique-influencers">0</h3>
                    <p>Unique Influencers</p>
                </div>
                <div class="stat-card">
                    <h3 id="badge-types">8</h3>
                    <p>Badge Types Available</p>
                </div>
            </div>

            <div class="demo-controls">
                <h3>üéØ Interactive Badge Issuer</h3>
                
                <div class="control-group">
                    <label for="influencer-id">Influencer ID:</label>
                    <input type="text" id="influencer-id" value="INF_DEMO_001" placeholder="INF_123">
                </div>

                <div class="control-group">
                    <label for="badge-type">Badge Type:</label>
                    <select id="badge-type">
                        <option value="TopChef">üç≥ Top Chef</option>
                        <option value="FoodieInfluencer">üçΩÔ∏è Foodie Influencer</option>
                        <option value="RecipeCreator">üìù Recipe Creator</option>
                        <option value="CulinaryExpert">üë®‚Äçüç≥ Culinary Expert</option>
                        <option value="FoodPhotographer">üì∏ Food Photographer</option>
                        <option value="RestaurantReviewer">‚≠ê Restaurant Reviewer</option>
                        <option value="HealthyEating">ü•ó Healthy Eating Advocate</option>
                        <option value="BakingMaster">üßÅ Baking Master</option>
                    </select>
                </div>

                <div style="text-align: center; margin-top: 20px;">
                    <button class="btn" onclick="issueBadge()">üèÜ Issue Badge</button>
                    <button class="btn btn-success" onclick="showTestNotification()">üîî Test Notification</button>
                    <button class="btn btn-warning" onclick="refreshStats()">üìä Refresh Stats</button>
                </div>

                <div id="response-display" class="response-display" style="display: none;"></div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üöÄ Implementation Guide</h2>
            <p>Integrate the Badge Notification System into any website with just a few lines of code:</p>

            <h3>1. Include the Badge Notification Script</h3>
            <div class="code-block">
                <pre>&lt;script src="https://influencer-awards-engine-ia-e.vercel.app/badge-notify.js"&gt;&lt;/script&gt;</pre>
            </div>

            <h3>2. Initialize with Influencer ID</h3>
            <div class="code-block">
                <pre>&lt;script&gt;
new BadgeNotificationWidget({
    influencerId: 'INF_123',
    apiBaseUrl: 'https://influencer-awards-engine-ia-e.vercel.app',
    checkInterval: 30000 // Check every 30 seconds
});
&lt;/script&gt;</pre>
            </div>

            <h3>3. Auto-initialization with Data Attribute</h3>
            <div class="code-block">
                <pre>&lt;script src="https://influencer-awards-engine-ia-e.vercel.app/badge-notify.js" data-influencer-id="INF_123"&gt;&lt;/script&gt;</pre>
            </div>
        </div>

        <div class="demo-section">
            <h2>üîå API Endpoints</h2>
            <p>The badge system provides these RESTful API endpoints:</p>

            <div class="api-endpoint">
                <strong>POST</strong> /api/badges/issue<br>
                <small>Issue a new badge to an influencer</small>
            </div>

            <h3>Request Example:</h3>
            <div class="code-block">
                <pre>{
  "influencerId": "INF_123",
  "badge": "TopChef"
}</pre>
            </div>

            <h3>Response Example:</h3>
            <div class="code-block">
                <pre>{
  "badgeId": "BD_001"
}</pre>
            </div>

            <div class="api-endpoint">
                <strong>GET</strong> /api/badges?influencerId=INF_123<br>
                <small>Fetch all badges for a specific influencer</small>
            </div>

            <h3>Response Example:</h3>
            <div class="code-block">
                <pre>[
  {
    "badgeId": "BD_001",
    "influencerId": "INF_123",
    "badge": "TopChef",
    "awardedAt": "2024-01-15T10:30:00.000Z"
  }
]</pre>
            </div>
        </div>

        <div class="demo-section">
            <h2>‚ú® Features</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <h3>üîî Real-time Notifications</h3>
                    <p>Instant notifications when new badges are earned</p>
                </div>
                <div class="feature-card">
                    <h3>üèÜ Badge Management</h3>
                    <p>View and manage all earned badges in one place</p>
                </div>
                <div class="feature-card">
                    <h3>üîä Audio Alerts</h3>
                    <p>Optional sound notifications for new badges</p>
                </div>
                <div class="feature-card">
                    <h3>üì± Mobile Responsive</h3>
                    <p>Works perfectly on all devices and screen sizes</p>
                </div>
                <div class="feature-card">
                    <h3>‚ö° Lightweight</h3>
                    <p>Minimal JavaScript with no external dependencies</p>
                </div>
                <div class="feature-card">
                    <h3>üîí Secure API</h3>
                    <p>RESTful APIs with proper validation and error handling</p>
                </div>
            </div>
        </div>

        <div class="demo-section">
            <h2>üìà Technical Specifications</h2>
            <p>Built with modern web technologies for optimal performance:</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <h3>Next.js 15</h3>
                    <p>App Router with API Routes</p>
                </div>
                <div class="feature-card">
                    <h3>Firebase Firestore</h3>
                    <p>Real-time database for badge storage</p>
                </div>
                <div class="feature-card">
                    <h3>Vanilla JavaScript</h3>
                    <p>No framework dependencies for the widget</p>
                </div>
                <div class="feature-card">
                    <h3>Web Audio API</h3>
                    <p>Native browser sound notifications</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Load the Badge Notification Widget -->
    <script src="/badge-notify.js" data-influencer-id="INF_DEMO_001"></script>
    
    <script>
        let badgeWidget;
        const apiBaseUrl = window.location.hostname === 'localhost' ? 'http://localhost:3000' : 'https://influencer-awards-engine-ia-e.vercel.app';
        // Initialize the badge notification widget if loaded via script tag without data attribute
        // document.addEventListener('DOMContentLoaded', function() {
        //     badgeWidget = new BadgeNotificationWidget({
        //         influencerId: 'INF_DEMO_001',
        //         checkInterval: 10000 // Check every 10 seconds for demo
        //     });
            
        //     // Load initial stats
        //     refreshStats();
            
        //     console.log('Badge Notification Demo Loaded');
        // });

        document.addEventListener('DOMContentLoaded', function() {
            refreshStats();
        })

        async function issueBadge() {
            const influencerId = document.getElementById('influencer-id').value;
            const badgeType = document.getElementById('badge-type').value;
            const responseDisplay = document.getElementById('response-display');
            
            if (!influencerId || !badgeType) {
                showResponse('Please fill in all fields', 'error');
                return;
            }

            try {
                const response = await fetch(apiBaseUrl+'/api/badges/issue', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        influencerId: influencerId,
                        badge: badgeType
                    })
                });

                const data = await response.json();
                
                if (response.ok) {
                    showResponse(`Badge issued successfully!\nBadge ID: ${data.badgeId}`, 'success');
                    window.BadgeNotificationWidgetObject.checkNow();
                    // Refresh stats after issuing badge
                    setTimeout(refreshStats, 1000);
                    
                    // Trigger badge check if this is for the current demo user
                    if (influencerId === 'INF_DEMO_001' && badgeWidget) {
                        setTimeout(() => badgeWidget.checkNow(), 2000);
                    }
                } else {
                    showResponse(`Error: ${data.error}`, 'error');
                }
            } catch (error) {
                showResponse(`Network error: ${error.message}`, 'error');
            }
        }

        function showTestNotification() {
            if (badgeWidget) {
                badgeWidget.showTestNotification();
            }
        }

        async function refreshStats() {
            try {
                const response = await fetch(apiBaseUrl+'/api/badges');
                if (response.ok) {
                    const badges = await response.json();
                    
                    // Update stats
                    document.getElementById('total-badges').textContent = badges.length;
                    
                    const uniqueInfluencers = new Set(badges.map(b => b.influencerId)).size;
                    document.getElementById('unique-influencers').textContent = uniqueInfluencers;
                }
            } catch (error) {
                console.error('Error refreshing stats:', error);
            }
        }

        function showResponse(message, type) {
            const responseDisplay = document.getElementById('response-display');
            responseDisplay.textContent = message;
            responseDisplay.className = `response-display ${type}`;
            responseDisplay.style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                responseDisplay.style.display = 'none';
            }, 5000);
        }

        // Auto-refresh stats every 30 seconds
        setInterval(refreshStats, 30000);
    </script>
</body>
</html>